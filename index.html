<button id="connect">Connect</button>
<pre id="log"></pre>
<script>
const SERVICE_UUID = "4fafc201-1fb5-459e-8fcc-c5c9c331914b";
const CHAR_UUID    = "beb5483e-36e1-4688-b7f5-ea07361b26a8";
const logEl = document.getElementById("log");
const log = (m) => logEl.textContent += m + "\n";
 
document.getElementById("connect").onclick = async () => {
  try {
    log("Requesting device...");
    const device = await navigator.bluetooth.requestDevice({
      filters: [{ services: [SERVICE_UUID] }]
    });
 
    log("Connecting GATT...");
    const server = await device.gatt.connect();
 
    log("Getting service...");
    const service = await server.getPrimaryService(SERVICE_UUID);
 
    log("Getting characteristic...");
    const ch = await service.getCharacteristic(CHAR_UUID);
 
    log("Starting notifications...");
    await ch.startNotifications();
 
    ch.addEventListener("characteristicvaluechanged", (e) => {
      const dv = e.target.value;
      const txt = new TextDecoder().decode(dv.buffer);
      log("RX: " + txt);
    });
 
    log("✅ Listening!");
  } catch (e) {
    log("❌ " + e.name + ": " + e.message);
  }
};
</script>
